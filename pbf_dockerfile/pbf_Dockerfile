FROM ub-base
USER root
RUN apt-get update && apt-get install -y -q --no-install-recommends \
    ca-certificates \
    gnupg2 \
    nginx \
    nodejs \
    npm

RUN apt-get update && apt-get install -y nginx

# ARG USUARIO
# ARG PASSWD
# ARG TZ
# ARG PROYECTO
# ARG DB_USER
# ARG DB_PORT
# ARG PUERTO
# ARG GIT

ENV USUARIO=${USUARIO}
ENV PASSWD=${PASSWD}
ENV TZ=${TZ}
ENV PROYECTO=${PROYECTO}
ENV DB_USER=${DB_USER}
ENV DB_PORT=${DB_PORT}
ENV PUERTO=${PUERTO}
ENV GIT=${GIT}

ENV DB_HOST=${DB_HOST}
ENV DB_PORT2=${DB_PORT2}
ENV DB_USERNAME=${DB_USERNAME}
ENV DB_NAME=${DB_NAME}
ENV DB_PASSWORD=${DB_PASSWORD}
ENV PORT=${PORT}
ENV HOST_API=${HOST_API}
ENV JWT_SECRET=${JWT_SECRET}


COPY ./start-pbf-nginx.sh /root
RUN chmod +x /root/start-pbf-nginx.sh
RUN dos2unix /root/start-pbf-nginx.sh

EXPOSE 80

ENTRYPOINT [ "/root/start-pbf-nginx.sh" ]